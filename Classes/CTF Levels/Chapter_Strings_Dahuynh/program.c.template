#include <stdio.h>
#include <string.h>
#define USERDEF "AAAAAA"

char msg[] = \
"In this level, you will be forced to use dynamic analysis to find the\n\
password.  When programs are dynamically linked, it is possible to monitor\n\
their calls to the libraries they depend upon such as the strcmp() calls\n\
to the Standard C library.  While you can solve this level in many ways try\n\
using \"ltrace\".\n\n";

void print_msg() {
    printf("%s", msg);
}

int main(int argc, char* argv[]) {
    char buff[100];
    char pass[20];
    char c;
    int i;

    print_msg();

    // Create the password
    for (i = 0; i < 20; i++)
        pass[i] = 0;

    strncpy(pass, USERDEF, strlen(USERDEF));
    c = pass[0];
    pass[0] = pass[1];
    pass[1] = c;

    // Prompt for input
    printf("Enter password: ");
    scanf("%99s", buff);

    // Compare input to generated password
    if (strcmp(buff, pass) == 0) {
        printf("Correct!\n");
    } else {
        printf("Wrong.\n");
    }

    return 0;
}

